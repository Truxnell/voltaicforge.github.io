<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.4.1 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Fixing Intel Hardware decoding on Linux (Ubuntu) - VoltaicForge</title>




<meta name="description" content="Fixing steams broken libav libraries that break hardware accelerarion on Steam inhome streaming">




<meta name="author" content="Nat Allan">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="VoltaicForge">
<meta property="og:title" content="Fixing Intel Hardware decoding on Linux (Ubuntu)">


  <link rel="canonical" href="https://voltaicforge.com/linux/steam-vaapi-fix-linux/">
  <meta property="og:url" content="https://voltaicforge.com/linux/steam-vaapi-fix-linux/">



  <meta property="og:description" content="Fixing steams broken libav libraries that break hardware accelerarion on Steam inhome streaming">



  <meta name="twitter:site" content="@voltaicforge">
  <meta name="twitter:title" content="Fixing Intel Hardware decoding on Linux (Ubuntu)">
  <meta name="twitter:description" content="Fixing steams broken libav libraries that break hardware accelerarion on Steam inhome streaming">
  <meta name="twitter:url" content="https://voltaicforge.com/linux/steam-vaapi-fix-linux/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://voltaicforge.com/assets/images/linux_stock.png">
    
  

  
    <meta name="twitter:creator" content="@Nat Allan">
  



  

  



  <meta property="og:image" content="https://voltaicforge.com/assets/images/linux_stock.png">



  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-12-02T00:00:00+11:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Nat Allan",
      "url" : "https://voltaicforge.com",
      "sameAs" : ["https://twitter.com/voltaicforge"]
    }
  </script>



  <meta name="google-site-verification" content="iK_FoY5mh80PyafnPtAX6YOOtXL8eQ3Z8MqGBnTqK60" />


  <meta name="msvalidate.01" content="81692DABF6D3A748A99701D5182C57AB">


  <meta name="alexaVerifyID" content="mQysQJJ0XzBFJy5Y0GfkGmRIc_8">


  <meta name="yandex-verification" content="41039ce397f24d4e">

<!-- end SEO -->


<link href="https://voltaicforge.com/feed.xml" type="application/atom+xml" rel="alternate" title="VoltaicForge Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://voltaicforge.com/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="https://voltaicforge.com/">VoltaicForge</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="https://voltaicforge.com/year-archive/">Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://voltaicforge.com/projects/">Projects</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://voltaicforge.com/guides/">Guides</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://voltaicforge.com/about/">About</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://voltaicforge.com/assets/images/linux_stock.png');"
>
  
    <div class="wrapper">
      <h1 class="page__title" itemprop="headline">
        
          Fixing Intel Hardware decoding on Linux (Ubuntu)

        
      </h1>
      
        <p class="page__lead">Fixing steams broken libav libraries that break hardware accelerarion on Steam inhome streaming
</p>
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://voltaicforge.com/assets/images/profile.jpg" class="author__avatar" alt="Nat Allan" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">Nat Allan</h3>
    
      <p class="author__bio" itemprop="description">
        Analogue at birth, digital by design
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Victoria, Melbourne</span>
        </li>
      

      
        <li>
          <a href="http://voltaicforge.com" itemprop="url">
            <i class="fa fa-fw fa-chain" aria-hidden="true"></i> Website
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://twitter.com/voltaicforge" itemprop="sameAs">
            <i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/voltaicforge" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Fixing Intel Hardware decoding on Linux (Ubuntu)">
    <meta itemprop="description" content="Fixing steams broken libav libraries that break hardware accelerarion on Steam inhome streaming">
    <meta itemprop="datePublished" content="December 02, 2016">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        <h2 id="fix-for-lack-of-hardware-decoding-on-linux">Fix for lack of hardware decoding on Linux</h2>

<p>So I’ve switched to Linux recently (Mint 18).  I realised that since I was moving to Steam in-home streaming, I could move my clunky desktop tower out into the living room/server closet and run Linux on my desktop.  The only reason I’ve kept Windows running for so long was for gaming needs (and not wanting to fiddle around getting games to work on Linux)</p>

<p>Thankfully, with Steams push into the Linux front and throwing its weight behind the Debian side, gaming in Linux is a thing.  But it only supports about ~30% of my library, so my gaming PC needs to stay Windows.</p>

<p>After years of running Debian servers at home (and Freenas for years before that) linux feels more comfortable than Windows.  So I build a new mini-ITX, Intel i5 PC for desktop use, and moved the tower out into the living room.</p>

<p>Unfortunately, my experience with steam streaming was jelly mouse!  A quick check with setting ‘Display Performance information’ in the in home streaming client area revealed it was not using hardware acceleration.  It was using ‘libavcodec’, which is a software decoder.</p>

<p class="text-center"><a href="/assets/images/Steam_Advanced_Client_Options.png"><picture>
    <source srcset="https://voltaicforge.com/assets/images/resize/Steam_Advanced_Client_Options-440by444-169df3.png" media="(min-width: 40em) and (-webkit-min-device-pixel-ratio: 2.0), (min-width: 40em) and (min-resolution: 192dpi)" />
    <source srcset="https://voltaicforge.com/assets/images/resize/Steam_Advanced_Client_Options-440by444-169df3.png" media="(min-width: 40em) and (-webkit-min-device-pixel-ratio: 1.5), (min-width: 40em) and (min-resolution: 144dpi)" />
    <source srcset="https://voltaicforge.com/assets/images/resize/Steam_Advanced_Client_Options-440by444-169df3.png" media="(min-width: 40em)" />
    <source srcset="https://voltaicforge.com/assets/images/resize/Steam_Advanced_Client_Options-440by444-169df3.png" media="(-webkit-min-device-pixel-ratio: 2.0), (min-resolution: 192dpi)" />
    <source srcset="https://voltaicforge.com/assets/images/resize/Steam_Advanced_Client_Options-440by444-169df3.png" media="(-webkit-min-device-pixel-ratio: 1.5), (min-resolution: 144dpi)" />
    <source srcset="https://voltaicforge.com/assets/images/resize/Steam_Advanced_Client_Options-440by444-169df3.png" />
    <img src="https://voltaicforge.com/assets/images/resize/Steam_Advanced_Client_Options-440by444-169df3.png" alt="Steam Controller Unboxing" title="Steam Controller Unboxing" />
  </picture>
</a></p>
<p class="notice--info"><strong>Note:</strong> Check the ‘Display performance information box’ to enable perfomance info, and press F6 ingame to check.  Also, ensure you have ‘Enable Hardware decoding’ checked on the client.</p>

<p>This introduced a bit of lag in the decoding (&gt;50ms) which I could definitely notice.</p>

<h2 id="the-fix">The fix</h2>

<p>After much googling, the problem is that Steam on Ubuntu is bundled with its own libraries for VA-API.  Unfortunately, it is bundled with old drivers that no longer work/are broken.  The solution is to download the drivers from Ubuntu/your distros repo, remove Steams copy and <code class="highlighter-rouge">ln</code> (symlink) them to the host’s updated drivers.</p>

<p>Simply put, drop into terminal and <code class="highlighter-rouge">apt</code> the below:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>apt install i965-va-driver:i386
apt install libva1:i386
apt install libva-x11-1:i386
apt install libva-glx1:i386
</code></pre>
</div>

<p>This will install the proper drivers into <code class="highlighter-rouge">/usr/lib/i386-linux-gnu</code>.</p>

<p>Remove the old drivers from Steams folder (or <code class="highlighter-rouge">mv</code> them if you prefer)</p>

<div class="highlighter-rouge"><pre class="highlight"><code>rm ~/.steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/libva*
</code></pre>
</div>

<p>The last step is to symlink these to Steam’s local folder.  You can <code class="highlighter-rouge">ln -s</code> if you wish, but a kind folk has created a bash script to do it for us!</p>

<p>Grab the gist below (kindly created by Github user <a href="https://gist.github.com/benleov">Benleov</a>).  Alternatively, <code class="highlighter-rouge">wget</code> it with the below shell command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>wget https://gist.githubusercontent.com/benleov/dc44ca9505a807e7dcc9/raw/673a82ff3d2356d27c9355088f58335bc89ab46b/fix_steam_links &amp;&amp; chmod +x fix_steam_links
./fix_steam_links
</code></pre>
</div>
<p class="notice--info"><strong>Warning:</strong> Always check out the code that you are downloading code before executing to ensure its not malicious!</p>

<noscript><pre>400: Invalid request
</pre></noscript>
<script src="https://gist.github.com/dc44ca9505a807e7dcc9.js"> </script>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://voltaicforge.com/tags/#linux" class="page__taxonomy-item" rel="tag">Linux</a><span class="sep">, </span>
    
      
      
      <a href="https://voltaicforge.com/tags/#steam" class="page__taxonomy-item" rel="tag">Steam</a><span class="sep">, </span>
    
      
      
      <a href="https://voltaicforge.com/tags/#vaapi" class="page__taxonomy-item" rel="tag">VAAPI</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://voltaicforge.com/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-12-02T00:00:00+11:00">December 02, 2016</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=voltaicforge&text=Fixing Intel Hardware decoding on Linux (Ubuntu) https://voltaicforge.com/linux/steam-vaapi-fix-linux/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://voltaicforge.com/linux/steam-vaapi-fix-linux/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://voltaicforge.com/linux/steam-vaapi-fix-linux/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://voltaicforge.com/linux/steam-vaapi-fix-linux/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="https://voltaicforge.com/games/steam-controller-worthy-addition/" class="pagination--pager" title="Steam Controller - Worthy addition?
">Previous</a>
    
    
      <a href="https://voltaicforge.com/3dprinting/scp-upload-octopi/" class="pagination--pager" title="SCP upload to Octoprint on Linux
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://voltaicforge.com/assets/images/Code.jpg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://voltaicforge.com/homelab/setup-pfsense-for-tpg-nbn/" rel="permalink">Setup pfSense for TPG NBN
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">An adventure of frustration with TPG NBN and the missing VLAN setting
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://voltaicforge.com/assets/images/homebrew_fermenter.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://voltaicforge.com/homebrew/homebrewing-again/" rel="permalink">Homebrewing Again
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Beginning a homebrewing journey
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://voltaicforge.com/assets/images/encrypted_encfs_dropbox.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://voltaicforge.com/games/dropbox-encfs/" rel="permalink">Setting up Dropbox and encryption in Linux
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">My approach to setting up Dropbox and Encfs in Linux
</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://voltaicforge.com/assets/images/chromium-gnome-banner.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://voltaicforge.com/games/chromium-gnome-keyring/" rel="permalink">Stop Chromium asking for keyring unlock
</a>
      
    </h2>
    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read
</p>
    
    <p class="archive__item-excerpt" itemprop="description">Stopping Chromium asking for gnome-keyring login on launch
</p>
  </article>
</div>
        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/voltaicforge"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/voltaicforge"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://voltaicforge.com/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Nat Allan. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="https://voltaicforge.com/assets/js/main.min.js"></script>




  
<script type="text/javascript">
var clicky_site_ids = clicky_site_ids || [];
clicky_site_ids.push(101008004);
(function() {
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = '//static.getclicky.com/js';
  ( document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild( s );
})();
</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101008004ns.gif" /></p></noscript>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'voltaicforge';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>
